{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacoesView","MensagemView","Negociacao","Mensagem","ListaNegociacoes","NegociacaoService","DateHelper","Bind","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_negociacaoService","_ordemAtual","_init","listar","then","negociacoes","forEach","adiciona","catch","texto","erro","setInterval","console","log","importaNegociacoes","event","preventDefault","negociacao","_criaNegociacao","cadastrar","mensagem","_limpaFormulario","apagar","esvazia","importa","textoParaData","value","parseInt","parseFloat","coluna","ordena","a","b","inverteOrdem","focus","negociacaoController","currentInstance"],"mappings":";;;;;;;;;;;;;;;AAASA,qB,yBAAAA,e;;AACAC,kB,sBAAAA,Y;;AACAC,gB,qBAAAA,U;;AACAC,c,mBAAAA,Q;;AACAC,sB,2BAAAA,gB;;AACAC,uB,8BAAAA,iB;;AACAC,gB,sBAAAA,U;;AACAC,U,gBAAAA,I;;;;;;;;;;;;;;;;;;;;;AAEHC,0B;AACJ,wCAAc;AAAA;;AACZ,cAAIC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;AACA,eAAKG,UAAL,GAAkBJ,EAAE,OAAF,CAAlB;AACA,eAAKK,gBAAL,GAAwBL,EAAE,aAAF,CAAxB;AACA,eAAKM,WAAL,GAAmBN,EAAE,QAAF,CAAnB;;AAEA,eAAKO,iBAAL,GAAyB,IAAIT,IAAJ,CACvB,IAAIH,gBAAJ,EADuB,EAEvB,IAAIJ,eAAJ,CAAoBS,EAAE,mBAAF,CAApB,CAFuB,EAGvB,UAHuB,EAIvB,SAJuB,EAKvB,QALuB,EAMvB,cANuB,CAAzB;;AASA,eAAKQ,SAAL,GAAiB,IAAIV,IAAJ,CACf,IAAIJ,QAAJ,EADe,EAEf,IAAIF,YAAJ,CAAiBQ,EAAE,gBAAF,CAAjB,CAFe,EAGf,OAHe,CAAjB;AAKA,eAAKS,kBAAL,GAA0B,IAAIb,iBAAJ,EAA1B;AACA,eAAKc,WAAL,GAAmB,EAAnB;AACA,eAAKC,KAAL;AACD;;;;kCAEO;AAAA;;AACN,iBAAKF,kBAAL,CACGG,MADH,GAEGC,IAFH,CAEQ;AAAA,qBAAeC,YAAYC,OAAZ,CAAoB,MAAKR,iBAAL,CAAuBS,QAA3C,CAAf;AAAA,aAFR,EAGGC,KAHH,CAGS;AAAA,qBAAS,MAAKT,SAAL,CAAeU,KAAf,GAAuBC,IAAhC;AAAA,aAHT;;AAKAC,wBAAY,YAAM;AAChBC,sBAAQC,GAAR,CAAY,UAAZ;AACA,oBAAKC,kBAAL;AACD,aAHD,EAGG,IAHH;AAID;;;mCAEQC,K,EAAO;AAAA;;AACdA,kBAAMC,cAAN;;AAEA,gBAAMC,aAAa,KAAKC,eAAL,EAAnB;;AAEA,iBAAKlB,kBAAL,CACGmB,SADH,CACaF,UADb,EAEGb,IAFH,CAEQ,oBAAY;AAChB,qBAAKN,iBAAL,CAAuBS,QAAvB,CAAgCU,UAAhC;AACA,qBAAKlB,SAAL,CAAeU,KAAf,GAAuBW,QAAvB;AACA,qBAAKC,gBAAL;AACD,aANH,EAOGb,KAPH,CAOS,gBAAQ;AACb,qBAAKT,SAAL,CAAeU,KAAf,GAAuBC,IAAvB;AACD,aATH;AAUD;;;kCAEO;AAAA;;AACN,iBAAKV,kBAAL,CACGsB,MADH,GAEGlB,IAFH,CAEQ,oBAAY;AAChB,qBAAKN,iBAAL,CAAuByB,OAAvB;AACA,qBAAKxB,SAAL,CAAeU,KAAf,GAAuBW,QAAvB;AACD,aALH,EAMGZ,KANH,CAMS;AAAA,qBAAS,OAAKT,SAAL,CAAeU,KAAf,GAAuBC,IAAhC;AAAA,aANT;AAOD;;;+CAEoB;AAAA;;AACnB,iBAAKV,kBAAL,CACGwB,OADH,CACW,KAAK1B,iBAAL,CAAuBO,WADlC,EAEGD,IAFH,CAEQ,uBAAe;AACnBC,0BAAYC,OAAZ,CAAoB;AAAA,uBAClB,OAAKR,iBAAL,CAAuBS,QAAvB,CAAgCU,UAAhC,CADkB;AAAA,eAApB;AAGA,qBAAKlB,SAAL,CAAeU,KAAf,GAAuB,mCAAvB;AACD,aAPH,EAQGD,KARH,CAQS;AAAA,qBAAS,OAAKT,SAAL,CAAeU,KAAf,GAAuBC,IAAhC;AAAA,aART;AASD;;;4CAEiB;AAChB,mBAAO,IAAI1B,UAAJ,CACLI,WAAWqC,aAAX,CAAyB,KAAK9B,UAAL,CAAgB+B,KAAzC,CADK,EAELC,SAAS,KAAK/B,gBAAL,CAAsB8B,KAA/B,CAFK,EAGLE,WAAW,KAAK/B,WAAL,CAAiB6B,KAA5B,CAHK,CAAP;AAKD;;;iCAEMG,M,EAAQ;AACb,iBAAK/B,iBAAL,CAAuBgC,MAAvB,CAA8B,UAACC,CAAD,EAAIC,CAAJ;AAAA,qBAAUD,EAAEF,MAAF,IAAYG,EAAEH,MAAF,CAAtB;AAAA,aAA9B;AACA,gBAAI,KAAK5B,WAAL,IAAoB4B,MAAxB,EAAgC;AAC9B,mBAAK/B,iBAAL,CAAuBmC,YAAvB;AACD,aAFD,MAEO;AACL,mBAAKnC,iBAAL,CAAuBgC,MAAvB,CAA8B,UAACC,CAAD,EAAIC,CAAJ;AAAA,uBAAUD,EAAEF,MAAF,IAAYG,EAAEH,MAAF,CAAtB;AAAA,eAA9B;AACD;AACD,iBAAK5B,WAAL,GAAmB4B,MAAnB;AACD;;;6CAEkB;AACjB,iBAAKlC,UAAL,CAAgB+B,KAAhB,GAAwB,EAAxB;AACA,iBAAK9B,gBAAL,CAAsB8B,KAAtB,GAA8B,CAA9B;AACA,iBAAK7B,WAAL,CAAiB6B,KAAjB,GAAyB,CAAzB;AACA,iBAAK/B,UAAL,CAAgBuC,KAAhB;AACD;;;;;;AAGCC,0B,GAAuB,IAAI7C,oBAAJ,E;AAEpB,eAAS8C,eAAT,GAA2B;AAChC,eAAOD,oBAAP;AACD","file":"NegociacaoController.js","sourcesContent":["import { NegociacoesView } from \"../views/NegociacoesView\";\nimport { MensagemView } from \"../views/MensagemView\";\nimport { Negociacao } from \"../models/Negociacao\";\nimport { Mensagem } from \"../models/Mensagem\";\nimport { ListaNegociacoes } from \"../models/ListaNegociacoes\";\nimport { NegociacaoService } from \"../services/NegociacaoService\";\nimport { DateHelper } from \"../helpers/DateHelper\";\nimport { Bind } from \"../helpers/Bind\";\n\nclass NegociacaoController {\n  constructor() {\n    let $ = document.querySelector.bind(document);\n    this._inputData = $(\"#data\");\n    this._inputQuantidade = $(\"#quantidade\");\n    this._inputValor = $(\"#valor\");\n\n    this._listaNegociacoes = new Bind(\n      new ListaNegociacoes(),\n      new NegociacoesView($(\"#negociacoes-view\")),\n      \"adiciona\",\n      \"esvazia\",\n      \"ordena\",\n      \"inverteOrdem\"\n    );\n\n    this._mensagem = new Bind(\n      new Mensagem(),\n      new MensagemView($(\"#mensagem-view\")),\n      \"texto\"\n    );\n    this._negociacaoService = new NegociacaoService();\n    this._ordemAtual = \"\";\n    this._init();\n  }\n\n  _init() {\n    this._negociacaoService\n      .listar()\n      .then(negociacoes => negociacoes.forEach(this._listaNegociacoes.adiciona))\n      .catch(erro => (this._mensagem.texto = erro));\n\n    setInterval(() => {\n      console.log(\"Importou\");\n      this.importaNegociacoes();\n    }, 3000);\n  }\n\n  adiciona(event) {\n    event.preventDefault();\n\n    const negociacao = this._criaNegociacao();\n\n    this._negociacaoService\n      .cadastrar(negociacao)\n      .then(mensagem => {\n        this._listaNegociacoes.adiciona(negociacao);\n        this._mensagem.texto = mensagem;\n        this._limpaFormulario();\n      })\n      .catch(erro => {\n        this._mensagem.texto = erro;\n      });\n  }\n\n  apaga() {\n    this._negociacaoService\n      .apagar()\n      .then(mensagem => {\n        this._listaNegociacoes.esvazia();\n        this._mensagem.texto = mensagem;\n      })\n      .catch(erro => (this._mensagem.texto = erro));\n  }\n\n  importaNegociacoes() {\n    this._negociacaoService\n      .importa(this._listaNegociacoes.negociacoes)\n      .then(negociacoes => {\n        negociacoes.forEach(negociacao =>\n          this._listaNegociacoes.adiciona(negociacao)\n        );\n        this._mensagem.texto = \"NegociacÃ£o importada com sucesso.\";\n      })\n      .catch(erro => (this._mensagem.texto = erro));\n  }\n\n  _criaNegociacao() {\n    return new Negociacao(\n      DateHelper.textoParaData(this._inputData.value),\n      parseInt(this._inputQuantidade.value),\n      parseFloat(this._inputValor.value)\n    );\n  }\n\n  ordena(coluna) {\n    this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n    if (this._ordemAtual == coluna) {\n      this._listaNegociacoes.inverteOrdem();\n    } else {\n      this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n    }\n    this._ordemAtual = coluna;\n  }\n\n  _limpaFormulario() {\n    this._inputData.value = \"\";\n    this._inputQuantidade.value = 1;\n    this._inputValor.value = 0;\n    this._inputData.focus();\n  }\n}\n\nlet negociacaoController = new NegociacaoController();\n\nexport function currentInstance() {\n  return negociacaoController;\n}\n"]}